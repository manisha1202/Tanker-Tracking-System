<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>


<!-- <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="HandheldFriendly" content="true">


<meta name="viewport" content="width=device-width, initial-scale=1.0"> -->

<meta name="viewport" content="width=device-width, initial-scale=1"/>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>MagicEye</title>
    <meta name="description" content="MagicEye">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://localhost:8080/MagicEye/index.html">

    <link rel="icon" href="track.png">  

    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/cs-skin-elastic.css">
    <!-- <link rel="stylesheet" href="assets/css/bootstrap-select.less"> -->
    <link rel="stylesheet" href="assets/scss/style.css">
    <link href="assets/css/lib/vector-map/jqvmap.min.css" rel="stylesheet">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/html'>

  <style>
/* Tablet Landscape */
@media screen and (max-width: 1060px) {
    #primary { width:67%; }
    #secondary { width:30%; margin-left:3%;} 
}
/* Tabled Portrait */
@media screen and (max-width: 768px) {
    #primary { width:100%; }
    #secondary { width:100%; margin:0; border:none; }
}

@media (min-device-width:600px) {
    img[data-src-600px] {
        content: attr(data-src-600px, url);
    }
}
@media (min-device-width:800px) {
    img[data-src-800px] {
        content: attr(data-src-800px, url);
    }
}

.tile{

margin: 20px;
height:220px; width:280px;
display: inline-block !important;
border-radius: 10px;
}

.qwerty{
text-align:center; 
font-size:25px; 
font-weight:bold; 
color:#262626; 
margin:30px;
}

.figure{
 color: #f8f9fa;
 height:60px; 
 width:280px;
 text-align:center; 
 font-weight:bold; 
 font-size:40px;
 
}

</style> 


	<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
</head>
<body>
	
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBXsMfKFhI9_E4zu1CyZq77EJb91aZ5h2c",
    authDomain: "tankers-lorry.firebaseapp.com",
    databaseURL: "https://tankers-lorry.firebaseio.com",
    projectId: "tankers-lorry",
    storageBucket: "tankers-lorry.appspot.com",
    messagingSenderId: "29663184650"
  };
  firebase.initializeApp(config);
</script>
        <!-- Left Panel -->

    <aside id="left-panel" class="left-panel">
        <nav class="navbar navbar-expand-sm navbar-default">

            <div class="navbar-header">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fa fa-bars"></i>
                </button>
                <h2 style="color:white; font-family:Georgia; margin:7px;">MagicEye</h2>
            </div>

            <div id="main-menu" class="main-menu collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <a href="index.html"> <i class="menu-icon fa fa-dashboard"></i>Dashboard </a>
                    </li>
                    <h3 class="menu-title">UI elements</h3><!-- /.menu-title -->
                    <li class="menu-item-has-children dropdown">
              
                  <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-bar-chart"></i>Charts</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="menu-icon fa fa-line-chart"></i><a href="charts-chartjs.html">Chart JS</a></li>
                        
                        </ul>
                    </li>  

                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-area-chart"></i>Maps</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="menu-icon fa fa-map-o"></i><a href="maps-gmap.html">Google Maps</a></li>
                        </ul>
                    </li>
                
                </ul>
            </div><!-- /.navbar-collapse -->
        </nav>
    </aside><!-- /#left-panel -->

    <!-- Left Panel -->

    <!-- Right Panel -->

    <aside id="right-panel" class="right-panel">

        

        <div class="breadcrumbs">
            <div class="col-sm-4">
                <div class="page-header float-left">
                    <div class="page-title">
                        <h1>Tanker's Tracker</h1>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="page-header float-right">
                    <div class="page-title">
                        <ol class="breadcrumb text-right">
                            <li class="active"> <a href="index.html">Dashboard</a></li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
<br>
<br>
<br>

       
     <div class="tile" style="background-color:#22b2e5;"  >
     	<p  class="qwerty">TEMPERATURE</p>
		<div id="CURRTEMP"  class="figure" >
		</div>  
      </div>
      <div class="tile" style="background-color:#ffc107;" >
      	<p  class="qwerty">HUMIDITY</p>
		<div id="CURRHUMIDITY"  class="figure" >
		</div>
	  </div>
	  <div class="tile" style="background-color:#f86c6b;">
       	<p  class="qwerty" >VIBRATION</p>
       	<div id="VIBRATION"   class="figure">
       	</div>
	   </div>
	   <audio id="myAudio">
	   	<source src="Audio/Siren_Noise-KevanGC-1337458893.mp3" type="audio/mp3">
	   </audio>
			<script>
			window.onload = function () {
            	var currtemp=document.getElementById('CURRTEMP');
                var dbref3=firebase.database().ref().child('CURRTEMP').child('TEMP');
                dbref3.on('value',function(snap){
                	var val=snap.val().toFixed(2);
                        if(val>=40){
                        	window.alert("CAUTION - Temperature crossed the threshold value!!!");
                        	currtemp.style.color="#9E240A";
                        }
                        else{
                        	currtemp.style.color="#f8f9fa";
                        }
                        	
                        currtemp.innerText=val+" °C"; 
         		});
                
            	var currhum=document.getElementById('CURRHUMIDITY');
                var dbref2=firebase.database().ref().child('CURRHUMIDITY').child('HUMIDITY');
                dbref2.on('value',function(snap){
                	var val=snap.val().toFixed(2);
                    if(val>=75){
                    	window.alert("CAUTION - Humidity crossed the threshold value!!!");
                        currhum.style.color="#9E240A";
                    }
                    else{
                    	currhum.style.color="#f8f9fa";
                    }
                    	
                    currhum.innerText=val+" %";
                });
              
            	var vibration=document.getElementById('VIBRATION');
                var dbref4=firebase.database().ref().child('VIBRATION');
                var yVal;
                dbref4.on('value',function(snap){
                	var val=snap.val();
                    var j;
                 	for (j in val){
                    	yVal=val[j];
                    }
                    if(yVal>=400){
                    	window.alert("CAUTION - High Force exerted!!!  at:"+(new Date(parseFloat(j))));
                        vibration.style.color="#9E240A";
                    }
                    else{
                    	vibration.style.color="#f8f9fa";
                    }
                    vibration.innerText=yVal+" ips";
                });
           
       	var yVal1;
        var lat;
        var longt;
        var add;
        var j1;
        var lock=document.getElementById('LOCK');
        var dbref5=firebase.database().ref().child('LOCK');
        var dbref6 = firebase.database().ref().child('CURRGPS').child('LATITUDE');
        dbref6.on('value',function(snap){
        	var val=snap.val();
            var deg=val.split("°");
            var min=deg[1].split("'");
            var degnum=parseFloat(deg[0]);
            var minnum=parseFloat(min[0].trim());
            var secnum=parseFloat(min[1].trim());
            lat=degnum+(minnum/60)+(secnum/3600);
        });
        var dbref7 = firebase.database().ref().child('CURRGPS').child('LONGITUDE');
        dbref7.on('value',function(snap){
        	var val1=snap.val();
            var deg=val1.split("°");
            var min=deg[1].split("'");
            var degnum=parseFloat(deg[0]);
            var minnum=parseFloat(min[0].trim());
            var secnum=parseFloat(min[1].trim());
            longt=degnum+(minnum/60)+(secnum/3600);
            console.log("pre");
            dbref5.on('value',function(snap){
            	console.log("hello world!");
                var val=snap.val();
                for (j1 in val) {
                	yVal1=val[j1];
                }
                console.log("before init");
                init();
                console.log("after init");
            });
         });
         function init(){
         	console.log(lat);
            console.log(longt);
            var geocoder  = new google.maps.Geocoder();
            var myCenter = new google.maps.LatLng( lat ,longt);
            geocoder.geocode({'latLng': myCenter}, function (results, status) {
            	if(status == google.maps.GeocoderStatus.OK) {           
                	add=results[0].formatted_address;         
                    console.log(add);
                    console.log(add);
                    if(yVal1==0){
                    	var x = document.getElementById("myAudio"); 
                        x.play(); 
                        window.alert("CAUTION - Unlocked!!!"+"\n"+"\n"+ "TIME:  "+(new Date(parseFloat(j1)))+"\n"+"\n"+"LOCATION: "+ add);
                    }
                 }
             });
 		 }
			}
		</script>   
</aside> <!-- /#right-panel -->
<!-- Right Panel -->
	<script async defer
    	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAmy_ADPQnYEMV71hUxbHoliDXD2PH8Vwo&callback=initMap">
    </script>
    <script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/main.js"></script>


    <script src="assets/js/lib/chart-js/Chart.bundle.js"></script>
    <script src="assets/js/dashboard.js"></script>
  


</body>
</html>
